#include <stdio.h>

struct Process{
    int id,at,bt,ct,tat,wt,rem;
};

int main(){
    int n,i,q,time=0,done=0;
    
    printf("enter no of processes : ");
    scanf("%d",&n);
    struct Process p[n];
    
    for(i=0;i<n;i++){
        p[i].id=i+1;
        printf("enter AT & BT: ");
        scanf("%d%d",&p[i].at,&p[i].bt);
        p[i].rem=p[i].bt;
    }
    
    printf("enter time quantum: ");
    scanf("%d",&q);
    
    int gantt_id[1000],start[1000],end[1000],g=0;
    
    while(done<n){
        int executed=0;
        for(i=0;i<n;i++){
            if(p[i].rem>0 && p[i].at<=time){
                executed=1;
                int slice=(p[i].rem<q?p[i].rem:q);
                gantt_id[g]=p[i].id;
                start[g]=time;
                time+=slice;
                end[g]=time;
                g++;
                p[i].rem-=slice;
                
            if(p[i].rem==0){
                p[i].ct=time;
                p[i].tat=p[i].ct-p[i].at;
                p[i].wt=p[i].tat-p[i].bt;
                done++;
            }}
        }
        if(!executed){
                time++;
        }
    }
    printf("Gantt Chart\n");
    printf("|");
    for(i=0;i<g;i++){
        printf("\tP%d\t|",gantt_id[i]);
    }printf("\n");
    
    for(i=0;i<g;i++){
        printf("%d\t\t",start[i]);
    }printf("%d",end[g-1]);
    printf("\n");
    
    float avgTAT=0,avgWT=0;
    
    printf("\nProcess\tAT\tBT\tCT\tTAT\tWT\n");
    for(i=0;i<n;i++){
        printf("%d\t%d\t%d\t%d\t%d\t%d\n",p[i].id,p[i].at,p[i].bt,p[i].ct,p[i].tat,p[i].wt);
        avgTAT+=p[i].tat;
        avgWT+=p[i].wt;
    }
    printf("\nAverage TAT : %.2f Average WT : %.2f",avgTAT/n,avgWT/n);
    return 0;

}
